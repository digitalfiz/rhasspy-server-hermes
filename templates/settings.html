{% extends "layout.html" %}

<!-- Simplified view of Rhasspy profile -->

{% block body %}
<div class="form-group mb-3">
    <div class="form-row">
        <div class="col-auto">
            <button onclick="saveProfile()" class="btn btn-primary" title="Save all settings and restart Rhasspy">Save Settings</button>
        </div>
        <div class="col-auto">
            <a href="api/backup-profile" class="btn btn-success" title="Download zip file with profile files">Backup Profile</a>
        </div>
    </div>
</div>

<!-- siteId -->
<div class="form-group">
    <div class="form-row">
        <div class="col-auto">
            <label for="mqtt-siteid" class="col-form-label">siteId:</label>
        </div>
        <div class="col-6">
            <input id="mqtt-siteid" type="text" class="form-control" x-model="profile.mqtt.site_id" placeholder="default">
        </div>
    </div>
</div>
<!-- End siteId -->

<!-- MQTT -->
<div class="card" id="mqtt">
    <div class="card-header bg-dark" id="headingMqtt">
        <i class="fas fa-inverse fa-network-wired"></i>
        <button class="btn" x-bind:class="{ 'btn-outline-light': !profile.mqtt.enabled, 'btn-success': profile.mqtt.enabled }" data-toggle="collapse" data-target="#mqtt-collapse" aria-expanded="true" aria-controls="mqtt-collapse" :disabled="!profile.mqtt.enabled">
            <i class="fas fa-sort-down"></i>MQTT
        </button>

        <select class="ml-2" x-model="profile.mqtt.enabled">
            <option value="">Internal</option>
            <option value="true">External</option>
        </select>

        <span class="fa-stack ml-2" x-show="profile.mqtt.enabled != initialSystems.mqtt">
            <i class="fas fa-circle fa-stack-2x text-danger"></i>
            <i class="fas fa-power-off fa-stack-1x fa-inverse" title="Restart is required"></i>
        </span>
    </div>
    <div id="mqtt-collapse" class="collapse hide" aria-labelledby="headingMqtt" data-parent="#accordion">
        <div class="card-body">
            <div class="form-group">
                <div class="form-row">
                    <label for="mqtt-host" class="col-form-label">Host</label>
                    <div class="col-sm-auto">
                        <input id="mqtt-host" type="text" class="form-control" x-model="profile.mqtt.host" :disabled="!profile.mqtt.enabled">
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="form-row">
                    <label for="mqtt-port" class="col-form-label">Port</label>
                    <div class="col-sm-auto">
                        <input id="mqtt-port" type="text" class="form-control" x-model="profile.mqtt.port" :disabled="!profile.mqtt.enabled">
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="form-row">
                    <label for="mqtt-username" class="col-form-label">Username</label>
                    <div class="col-sm-auto">
                        <input id="mqtt-username" type="text" class="form-control" x-model="profile.mqtt.username" :disabled="!profile.mqtt.enabled">
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="form-row">
                    <label for="mqtt-password" class="col-form-label">Password</label>
                    <div class="col-sm-auto">
                        <input id="mqtt-password" type="password" class="form-control" x-model="profile.mqtt.password" :disabled="!profile.mqtt.enabled">
                    </div>
                </div>
            </div>
            <hr>
            <div class="form-group">
                <div class="form-row">
                    <div class="col-sm-auto">
                        <input id="mqtt-tls-enabled" type="checkbox" x-model="profile.mqtt.tls.enabled" :disabled="!profile.mqtt.enabled">
                        <label for="mqtt-tls-enabled" class="col-form-label">TLS over MQTT (encryption)</label>
                    </div>
                </div>
                <div class="form-row">
                    <div class="col">
                        <a target="_blank" href="https://www.eclipse.org/paho/clients/python/docs/#tls-set" title="Paho MQTT tls_set documentation">Documentation</a>
                    </div>
                </div>
            </div>
            <template x-if="profile.mqtt.tls.enabled">
                <div class="form-group">
                    <div class="form-row">
                        <label for="mqtt-tls-ca_certs" class="col-form-label">ca_certs</label>
                        <div class="col">
                            <input id="mqtt-tls-ca_certs" type="text" class="form-control" v-model="profile.mqtt.tls.ca_certs" :disabled="!profile.mqtt.enabled">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="mqtt-tls-cert_reqs" class="col-form-label">cert_reqs</label>
                        <div class="col-sm-auto">
                            <select id="mqtt-tls-cert_reqs" v-model="profile.mqtt.tls.cert_reqs" :disabled="!profile.mqtt.enabled">
                                <option value="CERT_REQUIRED" default>CERT_REQUIRED</option>
                                <option value="CERT_OPTIONAL">CERT_OPTIONAL</option>
                                <option value="CERT_NONE">CERT_NONE</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="mqtt-tls-certfile" class="col-form-label">certfile</label>
                        <div class="col">
                            <input id="mqtt-tls-certfile" type="text" class="form-control" v-model="profile.mqtt.tls.certfile" :disabled="!profile.mqtt.enabled">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="mqtt-tls-ciphers" class="col-form-label">ciphers</label>
                        <div class="col">
                            <input id="mqtt-tls-ciphers" type="text" placeholder="default ciphers" class="form-control" v-model="profile.mqtt.tls.ciphers" :disabled="!profile.mqtt.enabled">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="mqtt-tls-keyfile" class="col-form-label">keyfile</label>
                        <div class="col">
                            <input id="mqtt-tls-keyfile" type="text" class="form-control" v-model="profile.mqtt.tls.keyfile" :disabled="!profile.mqtt.enabled">
                        </div>
                    </div>
                </div>
            </template>
        </div>
    </div>
</div>
<!-- End MQTT -->

<!-- Audio Recording -->
<div class="card" id="microphone">
    <div class="card-header bg-dark" id="headingMicrophone">
        <h5 class="mb-0">
            <i class="fas fa-inverse fa-microphone"></i>
            <button class="btn" x-bind:class="{ 'btn-outline-light': profile.microphone.system == 'dummy', 'btn-success': profile.microphone.system != 'dummy' }" data-toggle="collapse" data-target="#microphone-collapse" aria-expanded="true" aria-controls="microphone-collapse" :disabled="profile.microphone.system == 'dummy'">
                <i class="fas fa-sort-down"></i>Audio Recording
            </button>
            <select class="ml-2" x-model="profile.microphone.system">
                <option value="dummy">Disabled</option>
                <option value="pyaudio">PyAudio</option>
                <option value="arecord">arecord</option>
                <option value="command">Local Command</option>
                <option value="hermes">Hermes MQTT</option>
            </select>

            <span class="fa-stack ml-2" x-show="profile.microphone.system != initialSystems.microphone">
                <i class="fas fa-circle fa-stack-2x text-danger"></i>
                <i class="fas fa-power-off fa-stack-1x fa-inverse" title="Restart is required"></i>
            </span>
        </h5>
    </div>
    <div id="microphone-collapse" class="collapse hide" aria-labelledby="headingMicrophone" data-parent="#accordion">
        <div class="card-body">

            <!-- PyAudio -->
            <div x-show="profile.microphone.system == 'pyaudio'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/audio-input/#pyaudio">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-xs-auto">
                            <label for="microphone-pyaudio-device">Device:</label>
                        </div>
                        <div class="col">
                            <input id="microphone-pyaudio-device" x-model="profile.microphone.pyaudio.device" type="text" class="form-control" placeholder="default">
                        </div>
                    </div>
                    <div class="form-row mt-2">
                        <div class="col">
                            <select id="microphone-pyaudio-devices" x-model="profile.microphone.pyaudio.device" class="form-control">
                                <option value="" selected>Default Device</option>
                            </select>
                        </div>
                        <div class="col-xs-auto">
                            <button onclick="refreshInputDevices('pyaudio')" class="btn btn-primary form-control">Refresh</button>
                        </div>
                        <div class="col-xs-auto">
                            <button onclick="testInputDevices('pyaudio')" class="btn btn-secondary form-control">Test</button>
                        </div>
                    </div>
                </div>
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <label for="microphone-pyaudio-udp-audio-port" class="col-form-label">UDP Audio (Output)</label>
                        <div class="col">
                            <input id="microphone-pyaudio-udp-audio-host" type="text" class="form-control" placeholder="host" x-model="profile.microphone.pyaudio.udp_audio_host" :disabled="profile.microphone.system != 'pyaudio'">
                        </div>
                        <div class="col">
                            <input id="microphone-pyaudio-udp-audio-port" type="text" class="form-control" placeholder="port" x-model="profile.microphone.pyaudio.udp_audio_port" :disabled="profile.microphone.system != 'pyaudio'">
                        </div>
                        <div class="col-auto text-muted">
                            (outside ASR listening)
                        </div>
                    </div>
                </div>
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <label for="microphone-pyaudio-siteid" class="col-form-label">Output siteId</label>
                        <div class="col">
                            <input id="microphone-pyaudio-siteid" type="text" class="form-control" x-model="profile.microphone.pyaudio.siteId" :disabled="profile.microphone.system != 'pyaudio'">
                        </div>
                        <div class="col-auto text-muted">
                            (output to different siteId)
                        </div>
                    </div>
                </div>
            </div>
            <!-- End PyAudio -->

            <!-- arecord -->
            <div x-show="profile.microphone.system == 'arecord'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/audio-input/#alsa">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-xs-auto">
                            <label for="microphone-arecord-device">Device:</label>
                        </div>
                        <div class="col">
                            <input id="microphone-arecord-device" x-model="profile.microphone.arecord.device" type="text" class="form-control" placeholder="default">
                        </div>
                    </div>
                    <div class="form-row mt-2">
                        <div class="col">
                            <select id="microphone-arecord-devices" x-model="profile.microphone.arecord.device" class="form-control">
                                <option value="" selected>Default Device</option>
                            </select>
                        </div>
                        <div class="col-xs-auto">
                            <button onclick="refreshInputDevices('arecord')" class="btn btn-primary form-control">Refresh</button>
                        </div>
                        <div class="col-xs-auto">
                            <button onclick="testInputDevices('arecord')" class="btn btn-secondary form-control">Test</button>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="microphone-arecord-udp-audio-port" class="col-form-label">UDP Audio (Output)</label>
                        <div class="col">
                            <input id="microphone-arecord-udp-audio-host" type="text" class="form-control" placeholder="host" x-model="profile.microphone.arecord.udp_audio_host" :disabled="profile.microphone.system != 'arecord'">
                        </div>
                        <div class="col">
                            <input id="microphone-arecord-udp-audio-port" type="text" class="form-control" placeholder="port" x-model="profile.microphone.arecord.udp_audio_port" :disabled="profile.microphone.system != 'arecord'">
                        </div>
                        <div class="col-auto text-muted">
                            (outside ASR listening)
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="microphone-arecord-siteid" class="col-form-label">Output siteId</label>
                        <div class="col">
                            <input id="microphone-arecord-siteid" type="text" class="form-control" x-model="profile.microphone.arecord.siteId" :disabled="profile.microphone.system != 'arecord'">
                        </div>
                    </div>
                </div>
            </div>
            <!-- End arecord -->

            <!-- Command -->
            <div x-show="profile.microphone.system == 'command'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/audio-input/#command">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="microphone-record-program" class="col-form-label">Record Program</label>
                        <div class="col">
                            <input id="microphone-record-program" type="text" class="form-control" x-model="profile.microphone.command.record_program" :disabled="profile.microphone.system != 'command'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="microphone-record-arguments" class="col-form-label">Record Arguments</label>
                        <div class="col">
                            <input id="microphone-record-arguments" type="text" class="form-control" x-model="profile.microphone.command.record_arguments" :disabled="profile.microphone.system != 'command'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="microphone-sample-rate" class="col-form-label">Sample Rate</label>
                        <div class="col">
                            <input id="microphone-sample-rate" type="text" class="form-control" x-model="profile.microphone.command.sample_rate" :disabled="profile.microphone.system != 'command'">
                        </div>
                        <div class="col-auto text-muted">
                            (Hertz)
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="microphone-sample-width" class="col-form-label">Sample Width</label>
                        <div class="col">
                            <input id="microphone-sample-width" type="text" class="form-control" x-model="profile.microphone.command.sample_width" :disabled="profile.microphone.system != 'command'">
                        </div>
                        <div class="col-auto text-muted">
                            (bytes)
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="microphone-channels" class="col-form-label">Channels</label>
                        <div class="col">
                            <input id="microphone-channels" type="text" class="form-control" x-model="profile.microphone.command.channels" :disabled="profile.microphone.system != 'command'">
                        </div>
                    </div>
                </div>
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <label for="microphone-list-program" class="col-form-label">List Program</label>
                        <div class="col">
                            <input id="microphone-list-program" type="text" class="form-control" x-model="profile.microphone.command.list_program" :disabled="profile.microphone.system != 'command'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="microphone-list-arguments" class="col-form-label">List Arguments</label>
                        <div class="col">
                            <input id="microphone-list-arguments" type="text" class="form-control" x-model="profile.microphone.command.list_arguments" :disabled="profile.microphone.system != 'command'">
                        </div>
                    </div>
                </div>
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <label for="microphone-test-program" class="col-form-label">Test Program</label>
                        <div class="col">
                            <input id="microphone-test-program" type="text" class="form-control" x-model="profile.microphone.command.test_program" :disabled="profile.microphone.system != 'command'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="microphone-test-arguments" class="col-form-label">Test Arguments</label>
                        <div class="col">
                            <input id="microphone-test-arguments" type="text" class="form-control" x-model="profile.microphone.command.test_arguments" :disabled="profile.microphone.system != 'command'">
                        </div>
                    </div>
                </div>
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <label for="microphone-command-udp-audio-port" class="col-form-label">UDP Audio Port</label>
                        <div class="col">
                            <input id="microphone-command-udp-audio-port" type="text" class="form-control" x-model="profile.microphone.command.udp_audio_port" :disabled="profile.microphone.system != 'command'">
                        </div>
                        <div class="col-auto text-muted">
                            (outside ASR listening)
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="microphone-command-siteid" class="col-form-label">Output siteId</label>
                        <div class="col">
                            <input id="microphone-command-siteid" type="text" class="form-control" x-model="profile.microphone.command.siteId" :disabled="profile.microphone.system != 'command'">
                        </div>
                        <div class="col-auto text-muted">
                            (output to different siteId)
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Command -->

            <!-- Hermes -->
            <div x-show="profile.microphone.system == 'hermes'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/services/#audio-input">Documentation</a>
                    </div>
                    <div class="form-row">
                        <p>
                            External service that supports the <a href="https://docs.snips.ai/reference/hermes">Hermes Protocol</a>
                        </p>
                    </div>
                </div>
            </div>
            <!-- End Hermes -->

            <div x-show="profile.microphone.system != 'dummy'">
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <input type="checkbox" id="toggle-audio-statistics" onclick="toggleAudioStatistics()">
                        <label for="toggle-audio-statistics" class="col-form-label">Audio Statistics</label>
                    </div>
                    <div class="form-row">
                        <div id="audio-statistics-connecting" class="alert alert-warning">Connecting to websocket...</div>
                    </div>
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="audio-current-energy" class="col-form-label">Current Energy:</label>
                        </div>
                        <div class="col">
                            <input type="text" id="audio-current-energy" readonly>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="audio-max-energy" class="col-form-label">Max Energy:</label>
                        </div>
                        <div class="col">
                            <input type="text" id="audio-max-energy" readonly>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="audio-min-energy" class="col-form-label">Min Energy:</label>
                        </div>
                        <div class="col">
                            <input type="text" id="audio-min-energy" readonly>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="audio-ratio-energy" class="col-form-label">Max/Current Ratio:</label>
                        </div>
                        <div class="col">
                            <input type="text" id="audio-ratio-energy" readonly>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- End Audio Recording -->

<!-- Wake Word -->
<div class="card" id="wake">
    <div class="card-header bg-dark" id="headingWake">
        <h5 class="mb-0">
            <i class="fas fa-inverse fa-exclamation-circle"></i>
            <button class="btn" x-bind:class="{ 'btn-outline-light': profile.wake.system == 'dummy', 'btn-success': profile.wake.system != 'dummy', 'btn-warning': !isWakeCompatible() }" data-toggle="collapse" data-target="#wake-collapse" aria-expanded="true" aria-controls="wake-collapse" :disabled="profile.wake.system == 'dummy'">
                <i class="fas fa-sort-down"></i>Wake Word
            </button>
            <select class="ml-2" x-model="profile.wake.system">
                <option value="dummy">Disabled</option>
                <option value="raven">Rhasspy Raven</option>
                <option value="porcupine">Porcupine</option>
                <option value="snowboy">Snowboy</option>
                <option value="precise">Mycroft Precise</option>
                <option value="pocketsphinx">Pocketsphinx</option>
                <option value="command">Local Command</option>
                <option value="hermes">Hermes MQTT</option>
            </select>

            <span class="fa-stack ml-2" x-show="profile.wake.system != initialSystems.wake">
                <i class="fas fa-circle fa-stack-2x text-danger"></i>
                <i class="fas fa-power-off fa-stack-1x fa-inverse" title="Restart is required"></i>
            </span>
            <i title="Wake system is not compatible with this profile" class="fas fa-exclamation-triangle text-warning ml-2" x-show="!isWakeCompatible()"></i>
        </h5>
    </div>
    <div id="wake-collapse" class="collapse hide" aria-labelledby="headingWake" data-parent="#accordion">
        <div class="card-body">

            <!-- Pocketsphinx -->
            <div x-show="profile.wake.system == 'pocketsphinx'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/wake-word/#pocketsphinx">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="wake-pocketsphinx-keyphrase" class="col-form-label">Wake Keyphrase</label>
                        <div class="col-sm-auto">
                            <input id="wake-pocketsphinx-keyphrase" type="text" class="form-control" x-model="profile.wake.pocketsphinx.keyphrase" :disabled="profile.wake.system != 'pocketsphinx'">
                        </div>
                        <div class="col text-muted">
                            3-4 syllables recommended
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="wake-pocketsphinx-sensitivity" class="col-form-label">Sensitivity</label>
                        <div class="col-sm-auto">
                            <input id="wake-pocketsphinx-sensitivity" type="number" min="0" max="1" step="0.1" class="form-control" x-model="pocketsphinxWakeSensitivity" :disabled="profile.wake.system != 'pocketsphinx'">
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Pocketsphinx -->

            <!-- Snowboy -->
            <div x-show="profile.wake.system == 'snowboy'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/wake-word/#snowboy">Documentation</a>
                    </div>
                    <div class="form-row">
                        <div class="col text-muted">
                            Put models in the <tt>snowboy</tt> directory in your profile
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-xs-auto">
                            <label for="wake-snowboy-model">Model:</label>
                        </div>
                        <div class="col">
                            <input id="wake-snowboy-model" x-model="profile.wake.snowboy.model" type="text" class="form-control">
                        </div>
                    </div>
                    <div class="form-row mt-2">
                        <div class="col-xs-auto">
                            <label for="wake-snowboy-hotwords">Available Models:</label>
                        </div>
                        <div class="col">
                            <select id="wake-snowboy-hotwords" x-model="profile.wake.snowboy.model" class="form-control">
                                <option value="" disabled>Select model</option>
                            </select>
                        </div>
                        <div class="col-xs-auto">
                            <button onclick="refreshHotwords('snowboy')" class="btn btn-primary form-control" title="Refresh snowboy models">Refresh</button>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="wake-snowboy-sensitivity" class="col-form-label">Sensitivity</label>
                        <div class="col-sm-auto">
                            <input id="wake-snowboy-sensitivity" type="text" class="form-control" x-model="profile.wake.snowboy.sensitivity" :disabled="profile.wake.system != 'snowboy'"> <span class="text-muted">(comma-separated)</span>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <input type="checkbox" id="wake-snowboy-applyfrontend" x-model="profile.wake.snowboy.apply_frontend" :disabled="profile.wake.system != 'snowboy'">
                        <label for="wake-snowboy-applyfrontend" class="col-form-label">Apply Frontend (<a href="https://github.com/kitt-ai/snowboy#pretrained-universal-models" title="Parameters for pre-trained models">more info</a>)</label>
                    </div>
                </div>
                <div class="form-group">
                    <p>
                        See <a target="_blank" href="docs/wake-word/#snowboy">documentation</a> for how to use multiple wake words.
                    </p>
                </div>
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <label for="wake-snowboy-udp-audio" class="col-form-label">UDP Audio (Input)</label>
                        <div class="col">
                            <input id="wake-snowboy-udp-audio" type="text" class="form-control" placeholder="host1:port1:siteId1,host2:port2:siteId2" x-model="profile.wake.snowboy.udp_audio" :disabled="profile.wake.system != 'snowboy'">
                        </div>
                        <div class="col-auto text-muted">
                            (outside ASR listening)
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Snowboy -->

            <!-- Porcupine -->
            <div x-show="profile.wake.system == 'porcupine'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/wake-word/#porcupine">Documentation</a>
                    </div>
                    <div class="form-row">
                        <div class="col text-muted">
                            Put models in the <tt>porcupine</tt> directory in your profile
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-xs-auto">
                            <label for="wake-porcupine-keyword-file">Keyword File:</label>
                        </div>
                        <div class="col">
                            <input id="wake-porcupine-keyword-file" x-model="profile.wake.porcupine.keyword_path" type="text" class="form-control">
                        </div>
                    </div>
                    <div class="form-row mt-2">
                        <div class="col-xs-auto">
                            <label for="wake-porcupine-hotwords">Available Keywords:</label>
                        </div>
                        <div class="col">
                            <select id="wake-porcupine-hotwords" x-model="profile.wake.porcupine.keyword_path" class="form-control">
                                <option value="" disabled>Select keyword</option>
                            </select>
                        </div>
                        <div class="col-xs-auto">
                            <button onclick="refreshHotwords('porcupine')" class="btn btn-primary form-control" title="Refresh porcupine keywords">Refresh</button>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="wake-porcupine-sensitivity" class="col-form-label">Sensitivity</label>
                        <div class="col-sm-auto">
                            <input id="wake-porcupine-sensitivity" type="text" class="form-control" x-model="profile.wake.porcupine.sensitivity" :disabled="profile.wake.system != 'porcupine'"> <span class="text-muted">(comma-separated)</span>
                        </div>
                    </div>
                </div>
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <label for="wake-porcupine-udp-audio" class="col-form-label">UDP Audio (Input)</label>
                        <div class="col">
                            <input id="wake-porcupine-udp-audio" type="text" class="form-control" placeholder="host1:port1:siteId1,host2:port2:siteId2" x-model="profile.wake.porcupine.udp_audio" :disabled="profile.wake.system != 'porcupine'">
                        </div>
                        <div class="col-auto text-muted">
                            (outside ASR listening)
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Porcupine -->

            <!-- Mycroft Precise -->
            <div x-show="profile.wake.system == 'precise'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/wake-word/#precise">Documentation</a>
                    </div>
                    <div class="form-row">
                        <div class="col text-muted">
                            Put models in the <tt>precise</tt> directory in your profile
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-xs-auto">
                            <label for="wake-precise-model-file">Model File:</label>
                        </div>
                        <div class="col">
                            <input id="wake-precise-model-file" x-model="profile.wake.precise.model" type="text" class="form-control">
                        </div>
                    </div>
                    <div class="form-row mt-2">
                        <div class="col-xs-auto">
                            <label for="wake-precise-hotwords">Available Models:</label>
                        </div>
                        <div class="col">
                            <select id="wake-precise-hotwords" x-model="profile.wake.precise.model" class="form-control">
                                <option value="" disabled>Select model</option>
                            </select>
                        </div>
                        <div class="col-xs-auto">
                            <button onclick="refreshHotwords('precise')" class="btn btn-primary form-control" title="Refresh Mycroft Precise models">Refresh</button>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="wake-precise-sensitivity" class="col-form-label">Sensitivity</label>
                        <div class="col-sm-auto">
                            <input id="wake-precise-sensitivity" type="text" class="form-control" x-model="profile.wake.precise.sensitivity" :disabled="profile.wake.system != 'precise'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="wake-precise-trigger-level" class="col-form-label">Trigger Level</label>
                        <div class="col-sm-auto">
                            <input id="wake-precise-trigger-level" type="text" class="form-control" x-model="profile.wake.precise.trigger_level" :disabled="profile.wake.system != 'precise'">
                        </div>
                    </div>
                </div>
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <label for="wake-precise-udp-audio" class="col-form-label">UDP Audio (Input)</label>
                        <div class="col">
                            <input id="wake-precise-udp-audio" type="text" class="form-control" placeholder="host1:port1:siteId1,host2:port2:siteId2" x-model="profile.wake.precise.udp_audio" :disabled="profile.wake.system != 'precise'">
                        </div>
                        <div class="col-auto text-muted">
                            (outside ASR listening)
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Mycroft Precise -->


            <!-- Rhasspy Raven -->
            <div x-show="profile.wake.system == 'raven'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/wake-word/#raven">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        {% set raven_template_path = maybe_read_path(profile, "wake.raven.template_dir", "raven") %}
                        {% set raven_template_dir = profile.get("wake.raven.template_dir", "raven") %}
                        <ul>
                            <li>Template Directory: <tt>{{ raven_template_path }}</tt> </li>
                        </ul>
                    </div>
                </div>

                <!-- Examples -->
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="wake-raven-keyword-name" class="col-form-label">Wakeword Id:</label>
                        </div>
                        <div class="col">
                            <input id="wake-raven-keyword-name" type="text" class="form-control" value="default" onchange="resetRavenRecordings()" :disabled="profile.wake.system != 'raven'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-xs-auto">
                            <label for="wake-raven-hotwords">Available Keywords:</label>
                        </div>
                        <div class="col">
                            <select id="wake-raven-hotwords" onchange="$('#wake-raven-keyword-name').val($('#wake-raven-hotwords').val())" class="form-control">
                                <option value="" disabled>Select keyword</option>
                            </select>
                        </div>
                        <div class="col-xs-auto">
                            <button onclick="refreshHotwords('raven')" class="btn btn-primary form-control" title="Refresh Raven keywords">Refresh</button>
                        </div>
                    </div>
                </div>
                {% for i in range(3): %}
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <span id="raven-missing-{{ i }}" class="badge badge-info"></span>
                        </div>
                        <div class="col-auto">
                            <tt>Example {{ i + 1 }}</tt>
                        </div>
                        <div class="col-auto">
                            <button class="btn btn-success" title="Record wake word example" onclick="ravenRecord({{ i }}, '{{ raven_template_dir }}')">Record</button>
                        </div>
                    </div>
                </div>
                {% endfor %}

                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="wake-raven-probability-threshold" class="col-form-label">Probability Threshold</label>
                        </div>
                        <div class="col-sm-auto">
                            <input id="wake-raven-probability-threshold" x-model="profile.wake.raven.probability_threshold" :disabled="profile.wake.system != 'raven'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="raven-average-templates" class="col-form-label">Average Templates</label>
                        </div>
                        <div class="col">
                            <input type="checkbox" id="raven-average-templates" x-model="profile.wake.raven.average_templates">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="wake-raven-minimum-matches" class="col-form-label">Minimum Matches</label>
                        </div>
                        <div class="col">
                            <input id="wake-raven-minimum-matches" type="text" class="form-control" x-model="profile.wake.raven.minimum_matches" :disabled="profile.wake.system != 'raven'">
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="col-auto">
                        <label for="raven-vad-sensitivity" class="col-form-label">VAD Sensitivity:</label>
                    </div>
                    <div class="col">
                        <input id="raven-vad-sensitivity" type="text" class="form-control" x-model="profile.wake.raven.vad_sensitivity">
                    </div>
                    <div class="col-auto text-muted">
                        (1-3)
                    </div>
                </div>
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <label for="wake-raven-udp-audio" class="col-form-label">UDP Audio (Input)</label>
                        <div class="col">
                            <input id="wake-raven-udp-audio" type="text" class="form-control" placeholder="host1:port1:siteId1,host2:port2:siteId2" x-model="profile.wake.raven.udp_audio" :disabled="profile.wake.system != 'raven'">
                        </div>
                        <div class="col-auto text-muted">
                            (outside ASR listening)
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Command -->

            <!-- Command -->
            <div x-show="profile.wake.system == 'command'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/wake-word/#command">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="wake-program" class="col-form-label">Program</label>
                        <div class="col">
                            <input id="wake-program" type="text" class="form-control" x-model="profile.wake.command.program" :disabled="profile.wake.system != 'command'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="wake-arguments" class="col-form-label">Arguments</label>
                        <div class="col">
                            <input id="wake-arguments" type="text" class="form-control" x-model="profile.wake.command.arguments" :disabled="profile.wake.system != 'command'">
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Command -->

            <!-- Hermes -->
            <div x-show="profile.wake.system == 'hermes'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/services/#wake-word">Documentation</a>
                    </div>
                    <div class="form-row">
                        <p>
                            External service that supports the <a href="https://docs.snips.ai/reference/hermes">Hermes Protocol</a>
                        </p>
                    </div>
                </div>
            </div>
            <!-- End Hermes -->

            <!-- Satellite siteIds -->
            <div x-show="!['dummy', 'hermes'].includes(profile.wake.system)">
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="wake-satellite-siteids" class="col-form-label">Satellite siteIds:</label>
                        </div>
                        <div class="col">
                            <input id="wake-satellite-siteids" type="text" class="form-control" x-model="profile.wake.satellite_site_ids">
                        </div>
                        <div class="col-auto text-muted">
                            (comma-separated)
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- End Wake Word -->

<!-- Speech to Text -->
<div class="card" id="speech">
    <div class="card-header bg-dark" id="headingSpeech">
        <h5 class="mb-0">
            <i class="fas fa-inverse fa-phone-volume"></i>
            <button class="btn" x-bind:class="{ 'btn-outline-light': profile.speech_to_text.system == 'dummy', 'btn-success': profile.speech_to_text.system != 'dummy', 'btn-warning': !isSpeechCompatible() }" data-toggle="collapse" data-target="#speech-collapse" aria-expanded="true" aria-controls="collapseSpeech" :disabled="profile.speech_to_text.system == 'dummy'">
                <i class="fas fa-sort-down"></i>Speech to Text
            </button>
            <select class="ml-2" x-model="profile.speech_to_text.system">
                <option value="dummy">Disabled</option>
                <option value="pocketsphinx">Pocketsphinx</option>
                <option value="kaldi">Kaldi</option>
                <option value="deepspeech">Mozilla DeepSpeech</option>
                <option value="remote">Remote HTTP</option>
                <option value="command">Local Command</option>
                <option value="hermes">Hermes MQTT</option>
            </select>

            <span class="fa-stack ml-2" x-show="profile.speech_to_text.system != initialSystems.stt">
                <i class="fas fa-circle fa-stack-2x text-danger"></i>
                <i class="fas fa-power-off fa-stack-1x fa-inverse" title="Restart is required"></i>
            </span>
            <i title="Speech system is not compatible with this profile" class="fas fa-exclamation-triangle text-warning ml-2" x-show="!isSpeechCompatible()"></i>
        </h5>
    </div>
    <div id="speech-collapse" class="collapse hide" aria-labelledby="headingSpeech" data-parent="#accordion">
        <div class="card-body">

            <!-- Pocketsphinx -->
            <div x-show="profile.speech_to_text.system == 'pocketsphinx'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/speech-to-text/#pocketsphinx">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <ul>
                            <li>Acoustic Model: <tt>{{ maybe_read_path(profile, "speech_to_text.pocketsphinx.acoustic_model") }}</tt> </li>
                            <li>Dictionary: <tt>{{ maybe_read_path(profile, "speech_to_text.pocketsphinx.dictionary") }}</tt> </li>
                            <li>Language Model: <tt>{{ maybe_read_path(profile, "speech_to_text.pocketsphinx.language_model") }}</tt> </li>
                        </ul>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col">
                            <input type="checkbox" id="pocketsphinx-open" x-model="profile.speech_to_text.pocketsphinx.open_transcription">
                            <label for="pocketsphinx-open" class="col-form-label">
                                <a target="_blank" href="docs/speech-to-text/#open-transcription">
                                    Open transcription mode
                                </a>
                                (no custom voice commands)
                            </label>
                        </div>
                        <div class="col-auto">
                            <span class="fa-stack">
                                <i class="fas fa-circle fa-stack-2x text-info"></i>
                                <i class="fas fa-download fa-stack-1x fa-inverse" title="Requires extra download"></i>
                            </span>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <ul>
                            <li>Base Dictionary: <tt>{{ maybe_read_path(profile, "speech_to_text.pocketsphinx.base_dictionary") }}</tt> </li>
                            <li>Base Language Model: <tt>{{ maybe_read_path(profile, "speech_to_text.pocketsphinx.base_language_model") }}</tt> </li>
                        </ul>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="pocketsphinx-mix-weight" class="col-form-label">
                                <a target="_blank" href="docs/training/#language-model-mixing">
                                    Mixed Language Model Weight
                                </a>
                            </label>
                        </div>
                        <div class="col">
                            <input id="pocketsphinx-mix-weight" type="text" class="form-control" x-model="profile.speech_to_text.pocketsphinx.mix_weight">
                        </div>
                        <div class="col-auto">
                            <span class="text-muted">(0-1, 0 to disable)</span>
                        </div>
                        <div class="col-auto">
                            <span class="fa-stack">
                                <i class="fas fa-circle fa-stack-2x text-info"></i>
                                <i class="fas fa-download fa-stack-1x fa-inverse" title="Requires extra download"></i>
                            </span>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <ul>
                            <li>Base Language Model FST: <tt>{{ maybe_read_path(profile, "speech_to_text.pocketsphinx.base_language_model_fst") }}</tt> </li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- End Pocketsphinx -->

            <!-- Kaldi -->
            <div x-show="profile.speech_to_text.system == 'kaldi'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/speech-to-text/#kaldi">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <ul>
                            <li>Model Root: <tt>{{ maybe_read_path(profile, "speech_to_text.kaldi.model_dir") }}</tt> </li>
                            <li>Graph Directory: <tt>&lt;model_root&gt;/{{ profile.get("speech_to_text.kaldi.graph") }}</tt> </li>
                        </ul>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="kaldi-language-model-type" class="col-form-label">
                                Language Model Type:
                            </label>
                        </div>
                        <div class="col">
                            <select id="kaldi-language-model-type" class="form-control" x-model="profile.speech_to_text.kaldi.language_model_type">
                                <option value="arpa">ARPA</option>
                                <option value="text_fst">Text FST</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="form-row">
                        <div class="col">
                            <input type="checkbox" id="kaldi-open" x-model="profile.speech_to_text.kaldi.open_transcription">
                            <label for="kaldi-open" class="col-form-label">
                                <a target="_blank" href="docs/speech-to-text/#open-transcription">
                                    Open transcription mode
                                </a>
                                (no custom voice commands)
                            </label>
                        </div>
                        <div class="col-auto">
                            <span class="fa-stack">
                                <i class="fas fa-circle fa-stack-2x text-info"></i>
                                <i class="fas fa-download fa-stack-1x fa-inverse" title="Requires extra download"></i>
                            </span>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <ul>
                            <li>Base Dictionary: <tt>{{ maybe_read_path(profile, "speech_to_text.kaldi.base_dictionary") }}</tt> </li>
                            <li>Base Graph Directory: <tt>{{ maybe_read_path(profile, "speech_to_text.kaldi.base_graph") }}</tt> </li>
                            <li>Base Language Model: <tt>{{ maybe_read_path(profile, "speech_to_text.kaldi.base_language_model") }}</tt> </li>
                        </ul>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="kaldi-mix-weight" class="col-form-label">
                                <a target="_blank" href="docs/training/#language-model-mixing">
                                    Mixed Language Model Weight
                                </a>
                            </label>
                        </div>
                        <div class="col">
                            <input id="kaldi-mix-weight" type="text" class="form-control" x-model="profile.speech_to_text.kaldi.mix_weight">
                        </div>
                        <div class="col-auto">
                            <span class="text-muted">(0-1, 0 to disable)</span>
                        </div>
                        <div class="col-auto">
                            <span class="fa-stack">
                                <i class="fas fa-circle fa-stack-2x text-info"></i>
                                <i class="fas fa-download fa-stack-1x fa-inverse" title="Requires extra download"></i>
                            </span>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <ul>
                            <li>Base Language Model FST: <tt>{{ maybe_read_path(profile, "speech_to_text.kaldi.base_language_model_fst") }}</tt> </li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- End Kaldi -->

            <!-- DeepSpeech -->
            <div x-show="profile.speech_to_text.system == 'deepspeech'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/speech-to-text/#deepspeech">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <ul>
                            <li>Acoustic Model: <tt>{{ maybe_read_path(profile, "speech_to_text.deepspeech.acoustic_model") }}</tt> </li>
                            <li>Language Model: <tt>{{ maybe_read_path(profile, "speech_to_text.deepspeech.language_model") }}</tt> </li>
                            <li>Trie: <tt>{{ maybe_read_path(profile, "speech_to_text.deepspeech.trie") }}</tt> </li>
                        </ul>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col">
                            <input type="checkbox" id="deepspeech-open" x-model="profile.speech_to_text.deepspeech.open_transcription">
                            <label for="deepspeech-open" class="col-form-label">
                                <a target="_blank" href="docs/speech-to-text/#open-transcription">
                                    Open transcription mode
                                </a>
                                (no custom voice commands)
                            </label>
                        </div>
                        <div class="col-auto">
                            <span class="fa-stack">
                                <i class="fas fa-circle fa-stack-2x text-info"></i>
                                <i class="fas fa-download fa-stack-1x fa-inverse" title="Requires extra download"></i>
                            </span>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <ul>
                            <li>Base Language Model: <tt>{{ maybe_read_path(profile, "speech_to_text.deepspeech.base_language_model") }}</tt> </li>
                            <li>Base Trie: <tt>{{ maybe_read_path(profile, "speech_to_text.deepspeech.base_trie") }}</tt> </li>
                        </ul>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="deepspeech-mix-weight" class="col-form-label">
                                <a target="_blank" href="docs/training/#language-model-mixing">
                                    Mixed Language Model Weight
                                </a>
                            </label>
                        </div>
                        <div class="col">
                            <input id="deepspeech-mix-weight" type="text" class="form-control" x-model="profile.speech_to_text.deepspeech.mix_weight">
                        </div>
                        <div class="col-auto">
                            <span class="text-muted">(0-1, 0 to disable)</span>
                        </div>
                        <div class="col-auto">
                            <span class="fa-stack">
                                <i class="fas fa-circle fa-stack-2x text-info"></i>
                                <i class="fas fa-download fa-stack-1x fa-inverse" title="Requires extra download"></i>
                            </span>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <ul>
                            <li>Base Language Model FST: <tt>{{ maybe_read_path(profile, "speech_to_text.kaldi.base_language_model_fst") }}</tt> </li>
                        </ul>
                    </div>
                </div>
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="stt-satellite-siteids" class="col-form-label">Satellite siteIds:</label>
                        </div>
                        <div class="col">
                            <input id="stt-satellite-siteids" type="text" class="form-control" x-model="profile.speech_to_text.satellite_site_ids">
                        </div>
                        <div class="col-auto text-muted">
                            (comma-separated)
                        </div>
                    </div>
                </div>
            </div>
            <!-- End DeepSpeech -->

            <!-- Remote -->
            <div x-show="profile.speech_to_text.system == 'remote'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/speech-to-text/#remote">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="stt-url" class="col-form-label">Speech to Text URL</label>
                        <div class="col">
                            <input id="stt-url" type="text" class="form-control" x-model="profile.speech_to_text.remote.url" :disabled="profile.speech_to_text.system != 'remote'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col text-muted">
                            Example: http://localhost:12101/api/speech-to-text
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="stt-train-url" class="col-form-label">Training URL</label>
                        <div class="col">
                            <input id="stt-train-url" type="text" class="form-control" x-model="profile.training.speech_to_text.remote.url" :disabled="profile.speech_to_text.system != 'remote'">
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Remote -->

            <!-- Command -->
            <div x-show="profile.speech_to_text.system == 'command'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/speech-to-text/#command">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="stt-program" class="col-form-label">Program</label>
                        <div class="col">
                            <input id="stt-program" type="text" class="form-control" x-model="profile.speech_to_text.command.program" :disabled="profile.speech_to_text.system != 'command'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="stt-arguments" class="col-form-label">Arguments</label>
                        <div class="col">
                            <input id="stt-arguments" type="text" class="form-control" x-model="profile.speech_to_text.command.arguments" :disabled="profile.speech_to_text.system != 'command'">
                        </div>
                    </div>
                </div>
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="stt-satellite-siteids" class="col-form-label">Satellite siteIds:</label>
                        </div>
                        <div class="col">
                            <input id="stt-satellite-siteids" type="text" class="form-control" x-model="profile.speech_to_text.satellite_site_ids">
                        </div>
                        <div class="col-auto text-muted">
                            (comma-separated)
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Command -->

            <!-- Hermes -->
            <div x-show="profile.speech_to_text.system == 'hermes'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/services/#speech-to-text">Documentation</a>
                    </div>
                    <div class="form-row">
                        <p>
                            External service that supports the <a href="https://docs.snips.ai/reference/hermes">Hermes Protocol</a>
                        </p>
                    </div>
                </div>
            </div>
            <!-- End Hermes -->

            <div x-show="!['dummy', 'hermes'].includes(profile.speech_to_text.system)">
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="stt-satellite-siteids" class="col-form-label">Satellite siteIds:</label>
                        </div>
                        <div class="col">
                            <input id="stt-satellite-siteids" type="text" class="form-control" x-model="profile.speech_to_text.satellite_site_ids">
                        </div>
                        <div class="col-auto text-muted">
                            (comma-separated)
                        </div>
                    </div>
                </div>
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <h5>Voice Command Settings</h5>
                    </div>
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="pocketsphinx-skip-sec" class="col-form-label">Skip Before:</label>
                        </div>
                        <div class="col">
                            <input id="pocketsphinx-skip-sec" type="text" class="form-control" x-model="profile.command.webrtcvad.skip_sec">
                        </div>
                        <div class="col-auto text-muted">
                            (seconds)
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="pocketsphinx-min-sec" class="col-form-label">Minimum Duration:</label>
                        </div>
                        <div class="col">
                            <input id="pocketsphinx-min-sec" type="text" class="form-control" x-model="profile.command.webrtcvad.min_sec">
                        </div>
                        <div class="col-auto text-muted">
                            (seconds)
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="pocketsphinx-speech-sec" class="col-form-label">Speech Before:</label>
                        </div>
                        <div class="col">
                            <input id="pocketsphinx-speech-sec" type="text" class="form-control" x-model="profile.command.webrtcvad.speech_sec">
                        </div>
                        <div class="col-auto text-muted">
                            (seconds)
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="pocketsphinx-silence-sec" class="col-form-label">Silence After:</label>
                        </div>
                        <div class="col">
                            <input id="pocketsphinx-silence-sec" type="text" class="form-control" x-model="profile.command.webrtcvad.silence_sec">
                        </div>
                        <div class="col-auto text-muted">
                            (seconds)
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="pocketsphinx-silence-sec" class="col-form-label">Record Before:</label>
                        </div>
                        <div class="col">
                            <input id="pocketsphinx-before-sec" type="text" class="form-control" x-model="profile.command.webrtcvad.before_sec">
                        </div>
                        <div class="col-auto text-muted">
                            (seconds)
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="pocketsphinx-vad-mode" class="col-form-label">VAD Sensitivity:</label>
                        </div>
                        <div class="col">
                            <input id="pocketsphinx-vad-mode" type="text" class="form-control" x-model="profile.command.webrtcvad.vad_mode">
                        </div>
                        <div class="col-auto text-muted">
                            (1-3)
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
<!-- End Speech to Text -->

<!-- Intent Recognition -->
<div class="card" id="intent">
    <div class="card-header bg-dark" id="headingIntent">
        <h5 class="mb-0">
            <i class="fas fa-inverse fa-comment"></i>
            <button class="btn" x-bind:class="{ 'btn-outline-light': profile.intent.system == 'dummy', 'btn-success': profile.intent.system != 'dummy' }" data-toggle="collapse" data-target="#intent-collapse" aria-expanded="true" aria-controls="intent-collapse" :disabled="profile.intent.system == 'dummy'">
                <i class="fas fa-sort-down"></i>Intent Recognition
            </button>
            <select class="ml-2" x-model="profile.intent.system">
                <option value="dummy">Disabled</option>
                <option value="fsticuffs">Fsticuffs</option>
                <option value="fuzzywuzzy">Fuzzywuzzy</option>
                <option value="rasa">Rasa NLU</option>
                <!-- <option value="snips">Snips NLU</option> -->
                <option value="remote">Remote HTTP</option>
                <option value="command">Local Command</option>
                <option value="hermes">Hermes MQTT</option>
            </select>

            <span class="fa-stack ml-2" x-show="profile.intent.system != initialSystems.intent">
                <i class="fas fa-circle fa-stack-2x text-danger"></i>
                <i class="fas fa-power-off fa-stack-1x fa-inverse" title="Restart is required"></i>
            </span>
        </h5>
    </div>
    <div id="intent-collapse" class="collapse hide" aria-labelledby="headingIntent" data-parent="#accordion">
        <div class="card-body">

            <!-- Fsticuffs -->
            <div x-show="profile.intent.system == 'fsticuffs'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/intent-recognition/#fsticuffs">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <ul>
                            <li>Intent Graph: <tt>{{ maybe_read_path(profile, "intent.fsticuffs.intent_graph") }}</tt> </li>
                            <li>Stop Words: <tt>{{ maybe_read_path(profile, "intent.adapt.stop_words") }}</tt> </li>
                        </ul>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <input type="checkbox" id="fsticuffs-fuzzy" x-model="profile.intent.fsticuffs.fuzzy" :disabled="profile.intent.system != 'fsticuffs'">

                        <label for="fsticuffs-fuzzy" class="col-form-label">Fuzzy text matching</label>
                    </div>
                </div>
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="intent-satellite-siteids" class="col-form-label">Satellite siteIds:</label>
                        </div>
                        <div class="col">
                            <input id="intent-satellite-siteids" type="text" class="form-control" x-model="profile.intent.satellite_site_ids">
                        </div>
                        <div class="col-auto text-muted">
                            (comma-separated)
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Fsticuffs -->

            <!-- Fuzzywuzzy -->
            <div x-show="profile.intent.system == 'fuzzywuzzy'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/intent-recognition/#fuzzywuzzy">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="intent-fuzzywuzzy-min-confidence" class="col-form-label">Minimum Confidence:</label>
                        </div>
                        <div class="col">
                            <input id="intent-fuzzywuzzy-min-confidence" type="text" class="form-control" x-model="profile.intent.fuzzywuzzy.min_confidence">
                        </div>
                        <div class="col-auto text-muted">
                            (0-1, 1 is most strict)
                        </div>
                    </div>
                </div>
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="intent-satellite-siteids" class="col-form-label">Satellite siteIds:</label>
                        </div>
                        <div class="col">
                            <input id="intent-satellite-siteids" type="text" class="form-control" x-model="profile.intent.satellite_site_ids">
                        </div>
                        <div class="col-auto text-muted">
                            (comma-separated)
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Fuzzywuzzy -->

            <!-- Rasa NLU -->
            <div x-show="profile.intent.system == 'rasa'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/intent-recognition/#rasanlu">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="intent-rasa-url" class="col-form-label">Server URL:</label>
                        </div>
                        <div class="col">
                            <input id="intent-rasa-url" type="text" class="form-control" x-model="profile.intent.rasa.url">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col text-muted">
                            Example: http://localhost:5005
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <ul>
                            <li>Examples File: <tt>{{ maybe_read_path(profile, "intent.rasa.examples_markdown") }}</tt> </li>
                            <li>Intent Graph: <tt>{{ maybe_read_path(profile, "intent.fsticuffs.intent_graph") }}</tt> </li>
                        </ul>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="intent-rasa-project" class="col-form-label">Project Name:</label>
                        </div>
                        <div class="col">
                            <input id="intent-rasa-project" type="text" class="form-control" x-model="profile.intent.rasa.project_name">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="intent-rasa-config" class="col-form-label">YAML Config:</label>
                        </div>
                        <div class="col">
                            <input id="intent-rasa-config" type="text" class="form-control" x-model="profile.intent.rasa.config_yaml" placeholder="(auto-generated)">
                        </div>
                    </div>
                </div>
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="intent-satellite-siteids" class="col-form-label">Satellite siteIds:</label>
                        </div>
                        <div class="col">
                            <input id="intent-satellite-siteids" type="text" class="form-control" x-model="profile.intent.satellite_site_ids">
                        </div>
                        <div class="col-auto text-muted">
                            (comma-separated)
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Rasa NLU -->

            <!-- Snips NLU -->
            <div x-show="profile.intent.system == 'snips'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/intent-recognition/#snips-nlu">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <ul>
                            <li>Engine: <tt>{{ maybe_read_path(profile, "intent.snips.engine_dir") }}</tt> </li>
                            <li>Dataset: <tt>{{ maybe_read_path(profile, "intent.snips.dataset_file") }}</tt> </li>
                        </ul>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="intent-snips-language" class="col-form-label">Language:</label>
                        </div>
                        <div class="col">
                            <input id="intent-snips-language" type="text" class="form-control" placeholder="(profile language)" x-model="profile.intent.snips.language">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="col text-muted">
                            Supported Languages: de, en, es, fr, it, ja, ko, pt_br, pt_pt, zh
                        </div>
                    </div>
                </div>
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="intent-satellite-siteids" class="col-form-label">Satellite siteIds:</label>
                        </div>
                        <div class="col">
                            <input id="intent-satellite-siteids" type="text" class="form-control" x-model="profile.intent.satellite_site_ids">
                        </div>
                        <div class="col-auto text-muted">
                            (comma-separated)
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Snips NLU -->

            <!-- Remote -->
            <div x-show="profile.intent.system == 'remote'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/intent-recognition/#remote">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="intent-url" class="col-form-label">Rhasspy Text-to-Intent URL</label>
                        <div class="col">
                            <input id="intent-url" type="text" class="form-control" x-model="profile.intent.remote.url" :disabled="profile.intent.system != 'remote'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col text-muted">
                            Example: http://localhost:12101/api/text-to-intent
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="intent-train-url" class="col-form-label">Training URL</label>
                        <div class="col">
                            <input id="intent-train-url" type="text" class="form-control" x-model="profile.training.intent.remote.url" :disabled="profile.intent.system != 'remote'">
                        </div>
                    </div>
                </div>
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="intent-satellite-siteids" class="col-form-label">Satellite siteIds:</label>
                        </div>
                        <div class="col">
                            <input id="intent-satellite-siteids" type="text" class="form-control" x-model="profile.intent.satellite_site_ids">
                        </div>
                        <div class="col-auto text-muted">
                            (comma-separated)
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Remote -->

            <!-- Command -->
            <div x-show="profile.intent.system == 'command'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/intent-recognition/#command">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="intent-program" class="col-form-label">Program</label>
                        <div class="col">
                            <input id="intent-program" type="text" class="form-control" x-model="profile.intent.command.program" :disabled="profile.intent.system != 'command'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="intent-arguments" class="col-form-label">Arguments</label>
                        <div class="col">
                            <input id="intent-arguments" type="text" class="form-control" x-model="profile.intent.command.arguments" :disabled="profile.intent.system != 'command'">
                        </div>
                    </div>
                </div>
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="intent-satellite-siteids" class="col-form-label">Satellite siteIds:</label>
                        </div>
                        <div class="col">
                            <input id="intent-satellite-siteids" type="text" class="form-control" x-model="profile.intent.satellite_site_ids">
                        </div>
                        <div class="col-auto text-muted">
                            (comma-separated)
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Command -->

            <!-- Hermes -->
            <div x-show="profile.intent.system == 'hermes'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/services/#intent-recognition">Documentation</a>
                    </div>
                    <div class="form-row">
                        <p>
                            External service that supports the <a href="https://docs.snips.ai/reference/hermes">Hermes Protocol</a>
                        </p>
                    </div>
                </div>
            </div>
            <!-- End Hermes -->

        </div>
    </div>
</div>
<!-- End Intent Recognition -->

<!-- Text to Speech -->
<div class="card" id="tts">
    <div class="card-header bg-dark" id="headingTTS">
        <h5 class="mb-0">
            <i class="fas fa-inverse fa-paper-plane"></i>
            <button class="btn" x-bind:class="{ 'btn-outline-light': profile.text_to_speech.system == 'dummy', 'btn-success': profile.text_to_speech.system != 'dummy' }" data-toggle="collapse" data-target="#tts-collapse" aria-expanded="true" aria-controls="tts-collapse" :disabled="profile.text_to_speech.system == 'dummy'">
                <i class="fas fa-sort-down"></i>Text to Speech
            </button>
            <select class="ml-2" x-model="profile.text_to_speech.system">
                <option value="dummy">Disabled</option>
                <option value="espeak">Espeak</option>
                <option value="picotts">PicoTTS</option>
                <option value="nanotts">NanoTTS</option>
                <option value="flite">Flite</option>
                <option value="marytts">MaryTTS</option>
                <option value="wavenet">Google Wavenet</option>
                <option value="polly">Amazon Polly</option>
                <option value="opentts">OpenTTS</option>
                <option value="remote">Remote HTTP</option>
                <option value="command">Local Command</option>
                <option value="hermes">Hermes MQTT</option>
            </select>

            <span class="fa-stack ml-2" x-show="profile.text_to_speech.system != initialSystems.tts">
                <i class="fas fa-circle fa-stack-2x text-danger"></i>
                <i class="fas fa-power-off fa-stack-1x fa-inverse" title="Restart is required"></i>
            </span>
        </h5>
    </div>
    <div id="tts-collapse" class="collapse hide" aria-labelledby="headingTTS" data-parent="#accordion">
        <div class="card-body">

            <!-- Espeak -->
            <div x-show="profile.text_to_speech.system == 'espeak'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/text-to-speech/#espeak">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-xs-auto">
                            <label for="tts-espeak-voice">Voice:</label>
                        </div>
                        <div class="col">
                            <input id="tts-espeak-voice" x-model="profile.text_to_speech.espeak.voice" type="text" class="form-control" placeholder="default">
                        </div>
                    </div>
                    <div class="form-row mt-2">
                        <div class="col-xs-auto">
                            <label for="tts-espeak-voices">Available Voices:</label>
                        </div>
                        <div class="col">
                            <select id="tts-espeak-voices" x-model="profile.text_to_speech.espeak.voice" class="form-control">
                                <option value="" selected>Default Voice</option>
                            </select>
                        </div>
                        <div class="col-xs-auto">
                            <button onclick="refreshVoices('espeak')" class="btn btn-primary form-control" title="Refresh espeak voices">Refresh</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Espeak -->

            <!-- PicoTTS -->
            <div x-show="profile.text_to_speech.system == 'picotts'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/text-to-speech/#picotts">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="picotts-language" class="col-form-label">Language:</label>
                        <div class="col">
                            <input id="picotts-language" type="text" class="form-control" x-model="profile.text_to_speech.picotts.language" :disabled="profile.text_to_speech.system != 'picotts'" placeholder="default">
                        </div>
                    </div>
                </div>
            </div>
            <!-- End PicoTTS -->

            <!-- NanoTTS -->
            <div x-show="profile.text_to_speech.system == 'nanotts'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/text-to-speech/#nanotts">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="nanotts-language" class="col-form-label">Language:</label>
                        <div class="col">
                            <input id="nanotts-language" type="text" class="form-control" x-model="profile.text_to_speech.nanotts.language" :disabled="profile.text_to_speech.system != 'nanotts'" placeholder="default">
                        </div>
                    </div>
                </div>
            </div>
            <!-- End NanoTTS -->

            <!-- Flite -->
            <div x-show="profile.text_to_speech.system == 'flite'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/text-to-speech/#flite">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-xs-auto">
                            <label for="tts-flite-voice">Voice:</label>
                        </div>
                        <div class="col">
                            <input id="tts-flite-voice" x-model="profile.text_to_speech.flite.voice" type="text" class="form-control" placeholder="default">
                        </div>
                    </div>
                    <div class="form-row mt-2">
                        <div class="col-xs-auto">
                            <label for="tts-flite-voices">Available Voices:</label>
                        </div>
                        <div class="col">
                            <select id="tts-flite-voices" x-model="profile.text_to_speech.flite.voice" class="form-control">
                                <option value="" selected>Default Voice</option>
                            </select>
                        </div>
                        <div class="col-xs-auto">
                            <button onclick="refreshVoices('flite')" class="btn btn-primary form-control" title="Refresh flite voices">Refresh</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Flite -->

            <!-- MaryTTS -->
            <div x-show="profile.text_to_speech.system == 'marytts'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/text-to-speech/#marytts">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="marytts-url" class="col-form-label">URL:</label>
                        <div class="col">
                            <input id="marytts-url" type="text" class="form-control" x-model="profile.text_to_speech.marytts.url" :disabled="profile.text_to_speech.system != 'marytts'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="marytts-locale" class="col-form-label">Locale:</label>
                        <div class="col">
                            <input id="marytts-locale" type="text" class="form-control" x-model="profile.text_to_speech.marytts.locale" :disabled="profile.text_to_speech.system != 'marytts'" placeholder="default">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="marytts-voice" class="col-form-label">Voice:</label>
                        <div class="col">
                            <input id="marytts-voice" type="text" class="form-control" x-model="profile.text_to_speech.marytts.voice" :disabled="profile.text_to_speech.system != 'marytts'" placeholder="default">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-xs-auto">
                            <label for="tts-marytts-voices">Available Voices:</label>
                        </div>
                        <div class="col">
                            <select id="tts-marytts-voices" x-model="profile.text_to_speech.marytts.voice" class="form-control">
                                <option value="" selected>Default Voice</option>
                            </select>
                        </div>
                        <div class="col-xs-auto">
                            <button onclick="refreshVoices('marytts')" class="btn btn-primary form-control" title="Refresh marytts voices">Refresh</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- End MaryTTS -->

            <!-- Wavenet -->
            <div x-show="profile.text_to_speech.system == 'wavenet'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/text-to-speech/#wavenet">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="tts-wavenet-voices" class="col-form-label">Voice:</label>
                        </div>
                        <div class="col">
                            <select id="tts-wavenet-voices" x-model="profile.text_to_speech.wavenet.voice" class="form-control">
                            </select>
                        </div>
                        <div class="col-xs-auto">
                            <button onclick="refreshVoices('wavenet')" class="btn btn-primary form-control" title="Refresh wavenet voices">Refresh</button>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="wavenet-samplerate" class="col-form-label">Sample Rate</label>
                        </div>
                        <div class="col">
                            <select class="form-control" id="wavenet-samplerate" :disabled="profile.text_to_speech.system != 'wavenet'" x-model="profile.text_to_speech.wavenet.sample_rate">
                                <option value="8000">8000</option>
                                <option value="11025">11025</option>
                                <option value="16000">16000</option>
                                <option value="22050">22050</option>
                                <option value="44100">44100</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col text-muted">
                            <ul>
                                <li>Credentials: <tt>{{ maybe_read_path(profile, "text_to_speech.wavenet.credentials_json") }}</tt></li>
                                <li>WAV cache: <tt>{{ maybe_read_path(profile, "text_to_speech.wavenet.cache_dir") }}</tt></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Wavenet -->

            <!-- Polly -->
            <div x-show="profile.text_to_speech.system == 'polly'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/text-to-speech/#polly">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="tts-polly-voices" class="col-form-label">Voice:</label>
                        </div>
                        <div class="col">
                            <select id="tts-polly-voices" x-model="profile.text_to_speech.polly.voice" class="form-control">
                            </select>
                        </div>
                        <div class="col-xs-auto">
                            <button onclick="refreshVoices('polly')" class="btn btn-primary form-control" title="Refresh polly voices">Refresh</button>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="tts-polly-engine" class="col-form-label">Engine:</label>
                        </div>
                        <div class="col">
                            <select id="tts-polly-engine" x-model="profile.text_to_speech.polly.engine" class="form-control">
                                <option value="neural">Neural</option>
                                <option value="standard">Standard</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="polly-region" class="col-form-label">AWS Region:</label>
                        <div class="col">
                            <input id="polly-region" type="text" class="form-control" x-model="profile.text_to_speech.polly.region" :disabled="profile.text_to_speech.system != 'polly'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="polly-samplerate" class="col-form-label">Sample Rate</label>
                        </div>
                        <div class="col">
                            <select class="form-control" id="polly-samplerate" :disabled="profile.text_to_speech.system != 'polly'" x-model="profile.text_to_speech.polly.sample_rate">
                                <option value="8000">8000</option>
                                <option value="11025">11025</option>
                                <option value="16000">16000</option>
                                <option value="22050">22050</option>
                                <option value="44100">44100</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col text-muted">
                            <ul>
                                <li>Credentials: <tt>{{ maybe_read_path(profile, "text_to_speech.polly.credentials") }}</tt></li>
                                <li>WAV cache: <tt>{{ maybe_read_path(profile, "text_to_speech.polly.cache_dir") }}</tt></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Polly -->

            <!-- OpenTTS -->
            <div x-show="profile.text_to_speech.system == 'opentts'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/text-to-speech/#opentts">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="opentts-url" class="col-form-label">URL:</label>
                        <div class="col">
                            <input id="opentts-url" type="text" class="form-control" x-model="profile.text_to_speech.opentts.url" :disabled="profile.text_to_speech.system != 'opentts'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="opentts-voice" class="col-form-label">Voice:</label>
                        <div class="col">
                            <input id="opentts-voice" type="text" class="form-control" x-model="profile.text_to_speech.opentts.voice" :disabled="profile.text_to_speech.system != 'opentts'" placeholder="default">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-xs-auto">
                            <label for="tts-opentts-voices">Available Voices:</label>
                        </div>
                        <div class="col">
                            <select id="tts-opentts-voices" x-model="profile.text_to_speech.opentts.voice" class="form-control">
                                <option value="nanotts:en-GB" selected>Default Voice</option>
                            </select>
                        </div>
                        <div class="col-xs-auto">
                            <button onclick="refreshVoices('opentts')" class="btn btn-primary form-control" title="Refresh OpentTTS voices">Refresh</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- End OpenTTS -->

            <!-- Remote -->
            <div x-show="profile.text_to_speech.system == 'remote'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/text-to-speech/#remote">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="tts-url" class="col-form-label">Rhasspy Text-to-Speech URL</label>
                        <div class="col">
                            <input id="tts-url" type="text" class="form-control" x-model="profile.text_to_speech.remote.url" :disabled="profile.text_to_speech.system != 'remote'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col text-muted">
                            Example: http://localhost:12101/api/text-to-speech
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Remote -->

            <!-- Command -->
            <div x-show="profile.text_to_speech.system == 'command'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/text-to-speech/#command">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="tts-say-program" class="col-form-label">Say Program</label>
                        <div class="col">
                            <input id="tts-say-program" type="text" class="form-control" x-model="profile.text_to_speech.command.say_program" :disabled="profile.text_to_speech.system != 'command'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="tts-say-arguments" class="col-form-label">Arguments</label>
                        <div class="col">
                            <input id="tts-say-arguments" type="text" class="form-control" x-model="profile.text_to_speech.command.say_arguments" :disabled="profile.text_to_speech.system != 'command'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="tts-command-language" class="col-form-label">Default Language</label>
                        <div class="col">
                            <input id="tts-command-language" type="text" class="form-control" x-model="profile.text_to_speech.command.language" :disabled="profile.text_to_speech.system != 'command'">
                        </div>
                    </div>
                </div>
                <hr>
                <div class="form-group">
                    <div class="form-row">
                        <label for="tts-voices-program" class="col-form-label">Voices Program</label>
                        <div class="col">
                            <input id="tts-voices-program" type="text" class="form-control" x-model="profile.text_to_speech.command.voices_program" :disabled="profile.text_to_speech.system != 'command'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="tts-voices-arguments" class="col-form-label">Arguments</label>
                        <div class="col">
                            <input id="tts-voices-arguments" type="text" class="form-control" x-model="profile.text_to_speech.command.voices_arguments" :disabled="profile.text_to_speech.system != 'command'">
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Command -->

            <!-- Hermes -->
            <div x-show="profile.text_to_speech.system == 'hermes'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/services/#text-to-speech">Documentation</a>
                    </div>
                    <div class="form-row">
                        <p>
                            External service that supports the <a href="https://docs.snips.ai/reference/hermes">Hermes Protocol</a>
                        </p>
                    </div>
                </div>
            </div>
            <!-- End Hermes -->

            <!-- Satellite siteIds -->
            <div x-show="profile.text_to_speech.system != 'dummy'">
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="tts-satellite-siteids" class="col-form-label">Satellite siteIds:</label>
                        </div>
                        <div class="col">
                            <input id="tts-satellite-siteids" type="text" class="form-control" x-model="profile.text_to_speech.satellite_site_ids">
                        </div>
                        <div class="col-auto text-muted">
                            (comma-separated)
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Satellite siteIds -->

        </div>
    </div>
</div>
<!-- End Audio Recording -->

<!-- Audio Playing -->
<div class="card" id="sounds">
    <div class="card-header bg-dark" id="headingSounds">
        <h5 class="mb-0">
            <i class="fas fa-inverse fa-volume-up"></i>
            <button class="btn" x-bind:class="{ 'btn-outline-light': profile.sounds.system == 'dummy', 'btn-success': profile.sounds.system != 'dummy' }" data-toggle="collapse" data-target="#sounds-collapse" aria-expanded="true" aria-controls="sounds-collapse" :disabled="profile.sounds.system == 'dummy'">
                <i class="fas fa-sort-down"></i>Audio Playing
            </button>
            <select class="ml-2" x-model="profile.sounds.system">
                <option value="dummy">Disabled</option>
                <option value="aplay">aplay</option>
                <option value="remote">Remote HTTP</option>
                <option value="command">Local Command</option>
                <option value="hermes">Hermes MQTT</option>
            </select>

            <span class="fa-stack ml-2" x-show="profile.sounds.system != initialSystems.sounds">
                <i class="fas fa-circle fa-stack-2x text-danger"></i>
                <i class="fas fa-power-off fa-stack-1x fa-inverse" title="Restart is required"></i>
            </span>
        </h5>
    </div>
    <div id="sounds-collapse" class="collapse hide" aria-labelledby="headingSounds" data-parent="#accordion">
        <div class="card-body">

            <!-- aplay -->
            <div x-show="profile.sounds.system == 'aplay'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/audio-output/#alsa">Documentation</a>
                    </div>
                </div>
                <div class="form-row">
                    <div class="col-xs-auto">
                        <label for="sounds-aplay-device">Device:</label>
                    </div>
                    <div class="col">
                        <input id="sounds-aplay-device" x-model="profile.sounds.aplay.device" type="text" class="form-control">
                    </div>
                </div>
                <div class="form-row mt-2">
                    <div class="col-xs-auto">
                        <label for="sounds-aplay-devices">Available Devices:</label>
                    </div>
                    <div class="col">
                        <select id="sounds-aplay-devices" x-model="profile.sounds.aplay.device" class="form-control">
                            <option value="" selected>Default Device</option>
                        </select>
                    </div>
                    <div class="col-xs-auto">
                        <button onclick="refreshOutputDevices('aplay')" class="btn btn-primary form-control" placeholder="Refresh aplay devices">Refresh</button>
                    </div>
                </div>
            </div>
            <!-- End aplay -->

            <!-- Remote -->
            <div x-show="profile.sounds.system == 'remote'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/audio-output/#remote">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="tts-url" class="col-form-label">Audio Output URL</label>
                        <div class="col">
                            <input id="tts-url" type="text" class="form-control" x-model="profile.sounds.remote.url" :disabled="profile.sounds.system != 'remote'">
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Remote -->

            <!-- Command -->
            <div x-show="profile.sounds.system == 'command'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/audio-output/#command">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="sounds-program" class="col-form-label">Program</label>
                        <div class="col">
                            <input id="sounds-program" type="text" class="form-control" x-model="profile.sounds.command.play_program" :disabled="profile.sounds.system != 'command'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="sounds-arguments" class="col-form-label">Arguments</label>
                        <div class="col">
                            <input id="sounds-arguments" type="text" class="form-control" x-model="profile.sounds.command.play_arguments" :disabled="profile.sounds.system != 'command'">
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Command -->

            <!-- Hermes -->
            <div x-show="profile.sounds.system == 'hermes'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/services/#audio-output">Documentation</a>
                    </div>
                    <div class="form-row">
                        <p>
                            External service that supports the <a href="https://docs.snips.ai/reference/hermes">Hermes Protocol</a>
                        </p>
                    </div>
                </div>
            </div>
            <!-- End Hermes -->

        </div>
    </div>
</div>
<!-- End Audio Recording -->

<!-- Dialogue Management -->
<div class="card" id="dialogue">
    <div class="card-header bg-dark" id="headingDialogue">
        <h5 class="mb-0">
            <i class="fas fa-inverse fa-tasks"></i>
            <button class="btn" x-bind:class="{ 'btn-danger': profile.dialogue.system == 'dummy', 'btn-success': profile.dialogue.system != 'dummy' }" data-toggle="collapse" data-target="#dialogue-collapse" aria-expanded="true" aria-controls="dialogue-collapse" :disabled="profile.dialogue.system == 'dummy'">
                <i class="fas fa-sort-down"></i>Dialogue Management
            </button>
            <select class="ml-2" x-model="profile.dialogue.system">
                <option value="dummy">Disabled</option>
                <option value="rhasspy">Rhasspy</option>
                <option value="hermes">Hermes MQTT</option>
            </select>

            <span class="fa-stack ml-2" x-show="profile.dialogue.system != initialSystems.dialogue">
                <i class="fas fa-circle fa-stack-2x text-danger"></i>
                <i class="fas fa-power-off fa-stack-1x fa-inverse" title="Restart is required"></i>
            </span>
        </h5>
    </div>
    <div id="dialogue-collapse" class="collapse hide" aria-labelledby="headingDialogue" data-parent="#accordion">
        <div class="card-body">

            <!-- Rhasspy -->
            <div x-show="profile.dialogue.system == 'rhasspy'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/services/#dialogue-manager">Documentation</a>
                    </div>
                    <div class="form-row">
                        <p>
                            Uses <a href="https://github.com/rhasspy/rhasspy-dialogue-hermes">rhasspy-dialogue-hermes</a> service
                        </p>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="col-auto">
                            <label for="dialogue-satellite-siteids" class="col-form-label">Satellite siteIds:</label>
                        </div>
                        <div class="col">
                            <input id="dialogue-satellite-siteids" type="text" class="form-control" x-model="profile.dialogue.satellite_site_ids">
                        </div>
                        <div class="col-auto text-muted">
                            (comma-separated)
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Rhasspy -->

            <!-- Hermes -->
            <div x-show="profile.dialogue.system == 'hermes'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/services/#dialogue-manager">Documentation</a>
                    </div>
                    <div class="form-row">
                        <p>
                            External service that supports the <a href="https://docs.snips.ai/reference/hermes">Hermes Protocol</a>
                        </p>
                    </div>
                </div>
            </div>
            <!-- End Hermes -->

        </div>
    </div>
</div>
<!-- End Audio Playing -->

<!-- Intent Handling -->
<div class="card" id="handle">
    <div class="card-header bg-dark" id="headingHandle">
        <h5 class="mb-0">
            <i class="fas fa-inverse fa-bolt"></i>
            <button class="btn" x-bind:class="{ 'btn-outline-light': profile.handle.system == 'dummy', 'btn-success': profile.handle.system != 'dummy' }" data-toggle="collapse" data-target="#handle-collapse" aria-expanded="true" aria-controls="handle-collapse" :disabled="profile.handle.system == 'dummy'">
                <i class="fas fa-sort-down"></i>Intent Handling
            </button>
            <select class="ml-2" x-model="profile.handle.system">
                <option value="dummy">Disabled</option>
                <option value="hass">Home Assistant</option>
                <option value="remote">Remote HTTP</option>
                <option value="command">Local Command</option>
            </select>

            <span class="fa-stack ml-2" x-show="profile.handle.system != initialSystems.handle">
                <i class="fas fa-circle fa-stack-2x text-danger"></i>
                <i class="fas fa-power-off fa-stack-1x fa-inverse" title="Restart is required"></i>
            </span>
        </h5>
    </div>
    <div id="handle-collapse" class="collapse hide" aria-labelledby="headingHandle" data-parent="#accordion">
        <div class="card-body">
            <!-- Home Assistant -->
            <div x-show="profile.handle.system == 'hass'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/intent-handling/#home-assistant">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="hass-url" class="col-form-label">Hass URL</label>
                        <div class="col">
                            <input id="hass-url" type="text" class="form-control" x-model="profile.home_assistant.url"
                                   :disabled="profile.handle.system != 'hass'">
                        </div>
                        <div class="col text-muted">
                            Address of your Home Assistant server
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="hass-token" class="col-form-label">Access Token</label>
                        <div class="col">
                            <input id="hass-token" type="password" class="form-control" x-model="profile.home_assistant.access_token"
                                   :disabled="profile.handle.system != 'hass'">
                        </div>
                        <div class="col text-muted">
                            Long-lived access token (automatically filled in Hass.IO)
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="hass-password" class="col-form-label">API Password</label>
                        <div class="col">
                            <input id="hass-password" type="password" class="form-control" x-model="profile.home_assistant.api_password"
                                   :disabled="profile.handle.system != 'hass'">
                        </div>
                        <div class="col text-muted">
                            Home Assistant password (deprecated)
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" id="hass-handle-type-event" value="event" x-model="profile.home_assistant.handle_type" :disabled="profile.handle.system != 'hass'">
                            <label class="form-check-label" for="hass-handle-type-event">
                                Send <strong>events</strong> to Home Assistant (<tt>/api/events</tt>)
                            </label>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="col">
                            <p class="text-muted">
                                Events will be named <tt x-html="profile.home_assistant.event_type_format.replace('{0}', 'INTENT_NAME')"></tt>
                            </p>
                        </div>
                    </div>
                    <div class="form-row mt-2">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" id="hass-handle-type-intent" value="intent" x-model="profile.home_assistant.handle_type" :disabled="profile.handle.system != 'hass'">
                            <label class="form-check-label" for="hass-handle-type-intent">
                                Send <strong>intents</strong> to Home Assistant (<tt>/api/intent/handle</tt>)
                            </label>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="col">
                            <p class="text-muted">
                                Requires the <tt>intent</tt> component and <a href="https://www.home-assistant.io/integrations/intent_script">intent scripts</a> in your <tt>configuration.yaml</tt>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Home Assistant -->

            <!-- Remote -->
            <div x-show="profile.handle.system == 'remote'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/intent-handling/#remote-server">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="remote-handle-url" class="col-form-label">Remote URL</label>
                        <div class="col">
                            <input id="remote-handle-url" type="text" class="form-control" x-model="profile.handle.remote.url" :disabled="profile.handle.system != 'remote'">
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Remote -->

            <!-- Command -->
            <div x-show="profile.handle.system == 'command'">
                <div class="form-group">
                    <div class="form-row">
                        <a target="_blank" href="docs/intent-handling/#command">Documentation</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="handle-program" class="col-form-label">Program</label>
                        <div class="col">
                            <input id="handle-program" type="text" class="form-control" x-model="profile.handle.command.program" :disabled="profile.handle.system != 'command'">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-row">
                        <label for="handle-arguments" class="col-form-label">Arguments</label>
                        <div class="col">
                            <input id="handle-arguments" type="text" class="form-control" x-model="profile.handle.command.arguments" :disabled="profile.handle.system != 'command'">
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Command -->

        </div>
    </div>
</div>
<!-- End Intent Handling -->



<button onclick="saveProfile()" class="btn btn-primary mt-3" title="Save all settings and restart Rhasspy">Save Settings</button>

<!-- Sounds -->
<div class="card mt-3">
    <div class="card-header">
        <h5>Sounds</h5>
    </div>
    <div class="card-body">
        <div class="form-group">
            <div class="form-row">
                <p class="text-muted">WAV files to play when Rhasspy wakes up and is finished recording a voice command.</p>
            </div>
            <div class="form-row">
                <p class="text-muted">Use <tt>${RHASSPY_PROFILE_DIR}</tt> for your profile directory.</p>
            </div>
        </div>
        <div class="form-group">
            <div class="form-row">
                <label for="sounds-wake" class="col-form-label">Wake WAV</label>
                <div class="col">
                    <input id="sounds-wake" type="text" class="form-control" x-model="profile.sounds.wake">
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="form-row">
                <label for="sounds-recorded" class="col-form-label">Recorded WAV</label>
                <div class="col">
                    <input id="sounds-recorded" type="text" class="form-control" x-model="profile.sounds.recorded">
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="form-row">
                <label for="sounds-error" class="col-form-label">Error WAV</label>
                <div class="col">
                    <input id="sounds-error" type="text" class="form-control" x-model="profile.sounds.error">
                </div>
            </div>
        </div>
    </div>
</div>
<!-- End Sounds -->

<!-- SSL -->
<div class="card mt-3" id="ssl">
    <div class="card-header">
        <h5>Certificates</h5>
    </div>
    <div class="card-body">
        <div class="form-group">
            <div class="form-row">
                <div class="col-auto">
                    <label for="certfile" class="col-form-label col">Certificate Path:</label>
                </div>
                <div class="col">
                    <input id="certfile" type="text" class="form-control" x-model="profile.home_assistant.pem_file" placeholder="certfile">
                </div>
                <div class="col-auto">
                    <p class="muted"><a href="https://docs.python.org/3/library/ssl.html#combined-key-and-certificate">PEM certificate file</a> (required)</p>
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="form-row">
                <div class="col-auto">
                    <label for="keyfile" class="col-form-label col">Key Path:</label>
                </div>
                <div class="col">
                    <input id="keyfile" type="text" class="form-control" x-model="profile.home_assistant.key_file" placeholder="keyfile">
                </div>
                <div class="col-auto">
                    <p class="muted"><a href="https://docs.python.org/3/library/ssl.html#ssl-certificates">Private key file</a> (optional)</p>
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="form-row">
                <p class="muted">Paths should be absolute.</p>
                <p class="mited">Use <tt>$RHASSPY_PROFILE_DIR</tt> environment variable for the directory of this profile (<tt>{{ profile_dir }}</tt>)</p>
            </div>
        </div>
    </div>
</div>
<!-- End SSL -->

<button onclick="saveProfile()" class="btn btn-primary mt-3 mb-3" title="Save all settings and restart Rhasspy">Save Settings</button>


{% endblock %}

{% block script %}
<script type="text/javascript">
 var initialSystems = {};

 // POST to /api/profile to save and then restart Rhasspy
 function saveProfile() {
     rhasspy.postBusy('Saving profile',
                      '/api/profile',
                      JSON.stringify(rhasspy.profile),
                      false)
            .done(function() {
                if (window.confirm("Settings saved. Restart Rhasspy?")) {
                    rhasspy.restart();
                } else {
                    rhasspy.hideBusy();
                }
            });
 }

 // Load available audio input devices
 function refreshInputDevices(micSystem, suppressMessage = false) {
     var selectId = '#microphone-' + micSystem + '-devices';
     var message = (suppressMessage) ? '' : 'Refreshing microphones';
     $(selectId + ' option:not(:first)').remove();

     rhasspy.getBusy(message,
                     '/api/microphones')
            .done((r) => {
                Object.entries(r).forEach((kv) => {
                    var selected = (kv[0] == rhasspy.profile.microphone[micSystem].device) ? ' selected' : '';
                    $(selectId)
                        .append('<option value="' + kv[0] + '"' + selected + '>' + kv[1] + ' (' + kv[0] + ')</option>');
                });
            });
 }

 // Test available audio input devices
 function testInputDevices(micSystem) {
     var selectId = '#microphone-' + micSystem + '-devices';
     $(selectId + ' option:not(:first)').remove();

     rhasspy.getBusy('Testing microphones',
                     '/api/test-microphones')
            .done((r) => {
                Object.entries(r).forEach((kv) => {
                    $(selectId)
                        .append('<option value="' + kv[0] + '">' + kv[1] + ' (' + kv[0] + ')</option>');
                });
            });
 }

 // Load available audio output devices
 function refreshOutputDevices(soundSystem, suppressMessage = false) {
     var selectId = '#sounds-' + soundSystem + '-devices';
     var message = (suppressMessage) ? '' : 'Refreshing speakers';
     $(selectId + ' option:not(:first)').remove();

     rhasspy.getBusy(message,
                     '/api/speakers')
            .done((r) => {
                Object.entries(r).forEach((kv) => {
                    var selected = (kv[0] == rhasspy.profile.sounds[soundSystem].device) ? ' selected' : '';
                    $(selectId)
                        .append('<option value="' + kv[0] + '"' + selected + '>' + kv[1] + ' (' + kv[0] + ')</option>');
                });
            });
 }

 // Load available hot words
 function refreshHotwords(wakeSystem, suppressMessage = false) {
     var selectId = '#wake-' + wakeSystem + '-hotwords';
     var message = (suppressMessage) ? '' : 'Refreshing hotwords';
     $(selectId + ' option').remove();

     rhasspy.getBusy(message,
                     '/api/wake-words')
            .done((r) => {
               r.forEach((hotword) => {
                    var selected = (hotword.modelId == rhasspy.profile.wake[wakeSystem].modelId) ? ' selected' : '';
                    $(selectId)
                        .append('<option value="' + hotword.modelId + '"' + selected + '>' + hotword.modelWords + ' (' + hotword.modelId + ')</option>');
                });
            });
 }

 // Load available TTS voices
 function refreshVoices(ttsSystem, suppressMessage = false) {
     var selectId = '#tts-' + ttsSystem + '-voices';
     var message = (suppressMessage) ? '' : 'Refreshing voices';
     $(selectId + ' option:not(:first)').remove();

     rhasspy.getBusy(message,
                     '/api/tts-voices')
            .done((r) => {
                r.forEach((voice) => {
                    var description = voice.voiceId;
                    var selected = (voice.voiceId == rhasspy.profile.text_to_speech[ttsSystem].voice) ? ' selected' : '';
                    if (voice.description) {
                        description += ' (' + voice.description + ')';
                    }
                    $(selectId)
                        .append('<option value="' + voice.voiceId + '"' + selected + '>' + description + '</option>');
                });
            });
 }

 // Record an example for Rhasspy Raven
 function ravenRecord(i, dirname) {
     var wakewordId = $('#wake-raven-keyword-name').val();
     var filename = dirname + '/' + wakewordId + '/example-' + i + '.wav'

     var message = 'Speak wake word (' + filename + ')';
     var missing = $('#raven-missing-' + i);

     rhasspy.postBusy(message,
                     '/api/record-wake-example?savePath=' + filename)
            .done((r) => {
                // Change missing label
                missing.text('Recorded');
            });
 }

 function resetRavenRecordings() {
     for (var i = 0; i < 3; i++) {
         var missing = $('#raven-missing-' + i);
         missing.text('');
     }
 }

 function isSpeechCompatible() {
     var speechSystem = rhasspy.profile.speech_to_text.system;
     return rhasspy.profile.speech_to_text[speechSystem].compatible;
 }

 function isWakeCompatible() {
     var wakeSystem = rhasspy.profile.wake.system;
     return rhasspy.profile.wake[wakeSystem].compatible;
 }

 var energies = null;
 function toggleAudioStatistics() {
     if ($('#toggle-audio-statistics').prop('checked')) {
         // Enable audio stats
         payload = "on";
     } else {
         // Disable audio stats
         payload = "off";
     }

     $.post({
         url: '/api/audio-summaries',
         data: payload
     });
 }

 function updateEnergies() {
     // Update text boxes with recent audio summary info
     if (energies != null) {
         $('#audio-current-energy').val(energies.current_energy);
         $('#audio-max-energy').val(energies.max_energy);
         $('#audio-min-energy').val(energies.min_energy);
         $('#audio-ratio-energy').val(energies.max_current_ratio);
     }
 }

 function refreshSelects() {
    if ($('#tts-' + rhasspy.profile.text_to_speech.system + '-voices').length) {
        refreshVoices(rhasspy.profile.text_to_speech.system, true);
     }

     if ($('#wake-' + rhasspy.profile.wake.system + '-hotwords').length) {
         refreshHotwords(rhasspy.profile.wake.system, true);
     }

     if ($('#sounds-' + rhasspy.profile.sounds.system + '-devices').length) {
        refreshOutputDevices(rhasspy.profile.sounds.system, true);
     }

     if ($('#microphone-' + rhasspy.profile.microphone.system + '-devices').length) {
        refreshInputDevices(rhasspy.profile.microphone.system, true);
     }
 }

 $(document).ready(() => {
     // Highlight selected section from URL
     var hash = $(location).attr('hash') || '';
     if (hash.length > 0) {
         var header = hash + ' .card-header';
         $(header).addClass('bg-primary');
         $(header).removeClass('bg-dark');

         // Expand section
         $(hash + '-collapse').addClass('show');

         // Account for fixed header top
         // See: https://stackoverflow.com/questions/4086107/fixed-page-header-overlaps-in-page-anchors
         var offset = $(':target').offset();
         var scrollTo = offset.top - 70;
         $('html, body').animate({ scrollTop: scrollTo}, 0);
     }

     refreshSelects();

     rhasspy.makeWebSocket(
         '/api/events/audiosummary',
         (socket) => {
             $('#audio-statistics-connecting').hide();
             socket.onmessage = (e) => {
                 energies = JSON.parse(e.data);
             }
         });

     // Update audio energies 2x per second
     setInterval(updateEnergies, 500);
 })

</script>
{% endblock %}
